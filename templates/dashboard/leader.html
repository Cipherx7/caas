{% extends 'base.html' %}
{% load humanize %}
{% load unfold %}
{% block title %}Leader Dashboard{% endblock %}
{% block content %}
<section class="how">
  <div class="container">
    <div class="section-head">
      <h2>Leader Dashboard</h2>
      <div class="muted">{{ community.name }}{% if community.verified %} · Verified{% endif %}</div>
    </div>

    <section style="margin:12px 0 20px">
      <div class="section-head">
        <h3>Your communities</h3>
        <a class="btn btn-primary" href="/communities/new/">Create another</a>
      </div>
      <div class="card-grid">
        {% for c in my_communities %}
        <article class="card">
          <div class="card-badges">
            {% if c.verified %}<span class="badge">Verified</span>{% endif %}
          </div>
          <h3 style="margin:0 0 4px">{{ c.name }}</h3>
          {% if c.tagline %}<p class="muted" style="margin:0 0 6px">{{ c.tagline }}</p>{% else %}
          <p class="muted" style="margin:0 0 6px">{{ c.description }}</p>
          {% endif %}
          <p class="meta">{{ c.location }}</p>
          <div class="card-actions">
            <a class="btn btn-secondary" href="{% url 'community_detail' c.id %}">View</a>
            <a class="btn btn-primary" href="{% url 'community_manage_pk' c.id %}">Manage</a>
          </div>
        </article>
        {% empty %}
        <p class="muted">You don’t lead any communities yet. <a class="link" href="/communities/new/">Create one</a>.</p>
        {% endfor %}
      </div>
    </section>

    {% component "unfold/components/flex.html" with class="grid grid-cols-3 gap-4" %}
      {% component "unfold/components/card.html" %}
        {% component "unfold/components/text.html" %}Events{% endcomponent %}
        {% component "unfold/components/title.html" %}{{ stats.events }}{% endcomponent %}
      {% endcomponent %}
      {% component "unfold/components/card.html" %}
        {% component "unfold/components/text.html" %}Active Sponsors{% endcomponent %}
        {% component "unfold/components/title.html" %}{{ stats.sponsors }}{% endcomponent %}
      {% endcomponent %}
      {% component "unfold/components/card.html" %}
        {% component "unfold/components/text.html" %}Total Funding{% endcomponent %}
        {% component "unfold/components/title.html" %}₹{{ stats.funding_total|floatformat:0|intcomma }}{% endcomponent %}
      {% endcomponent %}
    {% endcomponent %}

    <div class="grid-two" style="margin-top:16px">
      <div class="card">
        <h3>Recent Sponsorships</h3>
        <div style="display:grid;gap:8px">
          {% for s in recent_sponsorships %}
          <div style="display:flex;justify-content:space-between;gap:8px">
            <div>{{ s.sponsor.name }}</div>
            <div class="muted">{{ s.date|date:'M d, Y' }}</div>
            <div>₹{{ s.amount|floatformat:0|intcomma }}</div>
          </div>
          {% empty %}
          <p class="muted">No sponsorships yet.</p>
          {% endfor %}
        </div>
      </div>
      <div class="card">
        <h3>Recent Events</h3>
        <div style="display:grid;gap:8px">
          {% for e in recent_events %}
          <div style="display:flex;justify-content:space-between;gap:8px">
            <div>{{ e.title }}</div>
            <div class="muted">{{ e.date|date:'M d, Y' }}</div>
          </div>
          {% empty %}
          <p class="muted">No events yet.</p>
          {% endfor %}
        </div>
      </div>
    </div>

    
  </div>
</section>
{% endblock %}
